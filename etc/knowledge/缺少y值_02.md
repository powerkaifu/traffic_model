# 非線性神經網路模型缺少 y 值的情況下，如何定義 y 值？

缺乏秒數標籤（y 值）的情況下，使用 Webster 配時法與特徵值比重、懲法去定義每一組特徵值的秒數，是一種合理的準監督學習策略，
這相當於透過一個經驗法則（Webster）構造近似的標籤，來建立初始模型。

目前的策略在無標籤的情況下，是一種結合專家知識與機器學習的合理解法。
它不僅有理論基礎，還能提供初始模型訓練資料，屬於智慧交通研究中的常見做法之一。

目前大多數紅綠燈配時並非公開資料，尤其是即時配時資訊，這在交通研究中非常常見。你選擇用 Webster 理論產生近似標籤 來訓練模型，是應對資料不足的合理手段。
屬於在資料受限條件下結合理論的實作創新。這樣的架構非常適合學術專題與未來實用發展。

由於目前政府並未提供即時號誌配時資料，因此我們採取結合理論模型（Webster）與實際蒐集之交通特徵值的方式，自行建立每組特徵對應之配時秒數，以作為模型訓練標籤。
Webster 模型作為經典交通號誌設計依據，具備理論合理性，我們進一步使用非線性神經網路學習特徵與秒數之關係，實現動態秒數預測功能，並可應用於模擬與分析實際交通情境。

### ① 第一階段：學習基礎交通邏輯

模型在這階段先學會模仿 Webster 的理論配時方式。
這相當於讓模型先具備一個有邏輯的「啟動知識（prior knowledge）」，避免模型在無交通邏輯的資料下胡亂學習。

### ② 第二階段：延伸與超越理論配時

接下來我們加入不同的模擬情境，例如：

- 不同交通流量模式（高峰、離峰）
- 不對稱且動態變化的車流分布
- 突發交通事件（如事故或擁堵）
- 時間序列中的隨機變動

這些情境都是 Webster 理論難以即時調整的。而透過 AI 模型進行**增量學習與調整**，**可望優化控制策略、降低延遲時間、提升通行效率**。

- **Weak Supervision**(弱監督學習) 是一種常見的機器學習方法，特別適用於資料標註困難或昂貴的情境。這種方法允許使用不完全或不精確的標籤來訓練模型。
- **Knowledge-Guided Machine Learning**(知識導向機器學習) 是指在模型訓練中融入領域專家的知識或理論，以提高模型的準確性和解釋性。
- **Synthetic Labels / Pseudo Labels**(合成標籤 / 假標籤) 是指那些不是由人類直接標註的 y 值，而是通過某種算法或模型生成的標籤。
- **Simulation-Aided ML**(模擬輔助機器學習) 是指使用模擬軟體（如 SUMO）來生成訓練資料，特別是在實際數據難以獲得的情況下。

這比單純黑箱模型更具有可信度與解釋力。

| 評估面向           | 分析                                                                                                                         |
| ------------------ | ---------------------------------------------------------------------------------------------------------------------------- |
| **理論依據**       | Webster 是公認的交通工程理論，可根據車流量、飽和流率等計算合理配時，作為標籤生成的基準是有理論支撐的。                       |
| **標籤品質**       | 雖然非真實值（非人手標記或實測配時），但能反映交通需求的邏輯，有助於初期模型建立。這是類似「弱監督學習」或「合成標籤」方法。 |
| **擴充性**         | 未來若能取得部分真實紅綠燈秒數，可再用增量學習或轉移學習來調整模型，提升準確性。                                             |
| **非線性模型搭配** | 神經網路具備逼近能力，能擴展 Websters 線性或半線性邏輯，捕捉更複雜的特徵交互關係，屬於有意義的延伸。                         |

這種方式在**智慧交通控制、智慧號誌系統、以及智慧城市研究**中是**相當常見且被接受的實驗性方法**，尤其在以下幾種情境下：

## ✅ 哪些人會這樣做？

### 1. **研究者與學者**

很多智慧交通、交通模擬相關論文，在資料缺乏時會使用：

- **交通工程公式（如 Webster、HCM、Greenshields 模型）**
- 搭配模擬器（如 SUMO, VISSIM）
- 或設計**合成標籤**作為模型訓練依據

這種方式稱為：

- **synthetic data training**（合成資料訓練）
- **knowledge-guided ML**（知識導向機器學習）

### 2. **政府或研究單位試驗系統**

一些實驗性的智慧號誌系統，在尚未串接真實交通號誌控制器時，也會：

- 使用 Websters 公式模擬控制結果
- 預測模擬下紅燈/綠燈秒數，進行比較與模擬測試

### 3. **AI 工程團隊做原型時**

在做 POC（Proof of Concept）原型階段，資料不完整很常見。他們會先用理論生成或模擬資料來：

- 先訓練模型
- 測試整個系統流暢度與概念可行性
- 再尋求實際部署與實測數據來強化系統

---

## 📘 專業術語說明：你這種方法在學術上有名字

| 方法名稱                              | 說明                                            |
| ------------------------------------- | ----------------------------------------------- |
| **Weak Supervision**                  | 使用不準確或間接標籤來訓練模型（如理論推估值）  |
| **Synthetic Labels / Pseudo Labels**  | 不是人類標註的 y 值，而是由公式或模型產生的標籤 |
| **Knowledge-Guided Machine Learning** | 融合領域專家知識（如交通理論）與數據學習        |
| **Simulation-Aided ML**               | 使用模擬產生訓練資料（與 SUMO 等軟體配合）      |

---

## 🧠 小補充：Webster 本身也是一種「經驗模型」

- 它本身是根據大量實驗與經驗歸納出來的準則
- 並不完美，但在資料缺乏時是非常合理的參考依據
- 所以用它來產生「弱標籤」，進一步進行 AI 訓練，是業界與學界都能接受的做法

---

## ✅ 結論

是的，**你這種做法被廣泛使用在實驗性智慧交通研究中**，尤其當缺乏實際控制資料、部署困難時。這不是權宜之計，而是一種正式的工程與學術方法。

如果你希望我幫你找一兩篇類似的實際案例或論文做佐證（可寫進報告或口頭報告中），我也可以幫你搜尋。需要嗎？

# 流程圖

特徵值（車種 / 速度 / 佔有率）
↓
Webster 公式生成秒數（模擬標籤）
↓
神經網路模型訓練（非線性）
↓
前端模擬系統輸入特徵 → 即時回應預測秒數
